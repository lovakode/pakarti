import{q as ae,r as p,w as oe,c as le,a as i,W as e,U as m,O as a,o as ne,T as d,u as o,$ as y}from"./@vue-BedgDXZT.js";import{a as q}from"./axios-D8rVyQy1.js";import{I as E}from"./@iconify-BzSLy_Lz.js";import{_ as I}from"./lodash-G2ORfQRs.js";import{u as se}from"./vue-i18n-3uPOuKlG.js";import{_ as re}from"./SkeletonTable-CkoHEoRM.js";import{u as me}from"./@tanstack-D5MgbqGz.js";import{u as ie,b as de}from"./app-DQL-JUcq.js";import{i as ce,f as ue,l as pe,j as _e,w as fe,x as ge,o as ve,k as be,y as ye,q as we,r as he,a as $e,b as Ee,c as ke,A as Ce,m as Ve,n as qe,B as Be,p as v,J as Se}from"./element-plus-B3W2dA5h.js";import"./@intlify-ChVUvfmF.js";import"./pinia-BVe78Fnf.js";import"./vue-router-CFFWa3Rv.js";import"./js-cookie-Cz0CWeBA.js";import"./@casl-Dl6lt6vV.js";import"./@ucast-BiZkLRnB.js";import"./@vueuse-_BfsD77n.js";import"./chart.js-B8s4pPcf.js";import"./vue-advanced-cropper-C5NvVQmq.js";import"./dayjs-BmnIqbSg.js";import"./vue3-blocks-tree-BkKvaGx5.js";import"./vue-BcxTvRm9.js";import"./@unhead-BU3UxbPv.js";import"./unhead-M3i9Ttrl.js";import"./hookable-B8xFkYCm.js";import"./@popperjs-D_chPuIy.js";import"./@element-plus-DHhqOHwO.js";import"./lodash-es-D7WVGOfI.js";import"./async-validator-9PlIezaS.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@ctrl-r5W6hzzQ.js";const De={class:"content"},Te={class:"content-header"},Fe={class:"mt-auto mb-0"},Ie={class:"text-lg font-semibold"},Me={class:"mt-auto mb-0"},je={class:"flex justify-between items-center p-4"},Ue={class:"flex items-center gap-2"},Le={class:"flex justify-between items-center p-4"},Pe={class:"flex items-center gap-2"},Re={class:"flex items-center gap-2"},xe={class:"text-end"},wt={__name:"Grade",setup(Ne){const{formatDate:B}=de(),{t:l}=se(),{setTitle:M}=ie();ae(()=>{M(l("base.grade",2))});const c=p({page:1,limit:25,q:""}),j=p([]),U=t=>{j.value=t};oe(()=>c.value.q,I.debounce(()=>{c.value.page=1,f()},500));const L=async({queryKey:t})=>{const[s,u]=t;return(await q.get("/settings/grade",{params:u})).data},{data:_,isLoading:w,isError:ze,error:Oe,refetch:f}=me({queryKey:["warehouseList",c.value],queryFn:L,keepPreviousData:!0});I.debounce(()=>{c.value.page=1,f()},2e3);const P=()=>{f()},R=t=>{c.value.page=t,f()},k=p(null),g=p(!1),C=p(""),r=p({id:null,name:null,short_name:null}),x=p({name:[{required:!0,message:l("validation.required",{attribute:l("common.name")}),trigger:"blur"}]}),S=p(!1),N=()=>{C.value=`${l("common.create")} ${l("base.grade")}`,g.value=!0,r.value.id=null,r.value.name=null},z=t=>{C.value=`${l("common.edit")} ${l("base.grade")}`,g.value=!0,r.value.id=t.id,r.value.name=t.name},D=()=>{g.value=!1,r.value.id=null,r.value.name=null},O=async()=>{k.value&&k.value.validate(async t=>{if(t){const s=Se.service({customClass:"rounded-md",target:document.querySelector("#modalForm")});try{S.value=!0;const u=r.value.id?`/settings/grade/${r.value.id}/update`:"/settings/grade/store",h=r.value.id?"put":"post";await q({method:h,url:u,data:r.value}),g.value=!1,f(),D(),v({message:l("message.success_save"),type:"success"})}catch{S.value=!1,v({message:l("message.error_server"),type:"error"})}s.close()}else v({message:l("message.error_input"),type:"error"})})},A=t=>{Be.confirm(l("message.delete_confirm"),l("message.delete_confirm_title"),{confirmButtonText:l("common.ok"),cancelButtonText:l("common.cancel"),type:"warning"}).then(()=>{q.delete(`/settings/grade/${t}/delete`).then(()=>{f(),v({type:"success",message:l("message.delete_success")})}).catch(s=>{v({type:"error",message:l("message.delete_cancel")})})}).catch(()=>{v({type:"info",message:l("message.delete_cancel")})})};return(t,s)=>{const u=_e,h=ce,V=ge,G=fe,T=ve,$=be,b=he,F=ke,H=Ee,J=$e,K=we,Q=Ce,W=ye,X=ue,Y=qe,Z=Ve,ee=pe;return ne(),le("div",De,[i("div",Te,[i("div",Fe,[i("div",Ie,m(t.$t("base.grade",2)),1)]),i("div",Me,[e(h,{separator:"/"},{default:a(()=>[e(u,{to:{path:"/"}},{default:a(()=>[d(m(t.$t("base.dashboard")),1)]),_:1}),e(u,null,{default:a(()=>[d(m(t.$t("base.setting",2)),1)]),_:1}),e(u,null,{default:a(()=>[d(m(t.$t("base.grade",2)),1)]),_:1})]),_:1})])]),e(X,{"body-class":"!p-0",class:"!rounded-lg !shadow-md"},{default:a(()=>[i("div",je,[e(G,{modelValue:c.value.limit,"onUpdate:modelValue":s[0]||(s[0]=n=>c.value.limit=n),placeholder:t.$t("common.select"),disabled:o(w),class:"w-20",onChange:s[1]||(s[1]=n=>o(f)())},{default:a(()=>[e(V,{label:"25",value:"25"}),e(V,{label:"50",value:"50"}),e(V,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","disabled"]),i("div",Ue,[e(T,{modelValue:c.value.q,"onUpdate:modelValue":s[2]||(s[2]=n=>c.value.q=n),clearable:"",disabled:o(w)},{prefix:a(()=>[e(o(E),{icon:"mingcute:search-line"})]),_:1},8,["modelValue","disabled"]),e($,{type:"primary",disabled:o(w),onClick:y(N,["prevent"])},{default:a(()=>[e(o(E),{icon:"mingcute:add-line",class:"me-2"}),d(" "+m(t.$t("common.create")),1)]),_:1},8,["disabled"])])]),e(W,{loading:o(w),animated:""},{template:a(()=>[e(re)]),default:a(()=>[e(K,{class:"min-w-full",data:o(_).data,onSortChange:P,onSelectionChange:U},{default:a(()=>[e(b,{type:"selection",width:"55"}),e(b,{prop:"name",label:t.$t("common.name"),sortable:""},null,8,["label"]),e(b,{label:t.$t("common.created_at")},{default:a(n=>[d(m(o(B)(n.row.created_at)),1)]),_:1},8,["label"]),e(b,{label:t.$t("common.last_updated")},{default:a(n=>[d(m(o(B)(n.row.updated_at)),1)]),_:1},8,["label"]),e(b,{label:t.$t("common.action"),align:"center",width:"150"},{default:a(n=>[e(J,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:a(()=>[e(H,null,{default:a(()=>[e(F,{class:"flex justify-between",onClick:y(te=>z(n.row),["prevent"])},{default:a(()=>[e(o(E),{icon:"mingcute:edit-line",class:"me-2"}),d(" "+m(t.$t("common.edit")),1)]),_:2},1032,["onClick"]),e(F,{class:"flex justify-between",onClick:y(te=>A(n.row.id),["prevent"])},{default:a(()=>[e(o(E),{icon:"mingcute:delete-2-line",class:"me-2"}),d(" "+m(t.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:a(()=>[e($,{type:"primary"},{default:a(()=>[d(m(t.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),i("div",Le,[i("div",Pe,[i("span",null,m(t.$t("common.table_paginate",{from:o(_).from,to:o(_).to,total:o(_).total})),1)]),i("div",Re,[e(Q,{class:"float-end",background:"",layout:"prev, pager, next","page-size":o(_).per_page,total:o(_).total,"current-page":o(_).current_page,onCurrentChange:R},null,8,["page-size","total","current-page"])])])]),_:1},8,["loading"])]),_:1}),e(ee,{id:"modalForm",modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=n=>g.value=n),title:C.value,class:"!sm:w-full !w-1/3 rounded-lg","close-on-click-modal":!1,"close-on-press-escape":!1},{default:a(()=>[e(Z,{"label-position":"top",ref_key:"formRef",ref:k,model:r.value,rules:x.value,onSubmit:y(O,["prevent"])},{default:a(()=>[e(Y,{label:t.$t("common.name"),prop:"name"},{default:a(()=>[e(T,{modelValue:r.value.name,"onUpdate:modelValue":s[3]||(s[3]=n=>r.value.name=n)},null,8,["modelValue"])]),_:1},8,["label"]),i("div",xe,[e($,{onClick:y(D,["prevent"])},{default:a(()=>[d(m(t.$t("common.cancel")),1)]),_:1}),e($,{type:"primary","native-type":"submit"},{default:a(()=>[d(m(t.$t("common.save")),1)]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{wt as default};
