import{q as te,r as u,c as ae,a as m,V as e,X as i,T as t,o as le,aa as c,u as a,W as y}from"./@vue-R74GAGRy.js";import{a as j}from"./axios-D8rVyQy1.js";import{I as E}from"./@iconify-B_FrOzP8.js";import{_ as ne}from"./lodash-BJPsjdUP.js";import{u as se}from"./vue-i18n-ZNZ64Gzf.js";import{_ as re}from"./SkeletonTable-BlkTH-8E.js";import{u as ie}from"./@tanstack-CrM5e4XN.js";import{u as me,b as ce}from"./app-DkR6lKKd.js";import{i as de,f as ue,l as pe,j as _e,s as fe,t as ge,o as be,k as ve,u as ye,q as he,r as we,a as $e,b as Ee,c as ke,y as Ce,m as Ve,n as je,z as qe,p as b,D as Se}from"./element-plus-m-0apcFn.js";import"./@intlify-ChVUvfmF.js";import"./pinia-AHalXmfd.js";import"./vue-router-LsEmCaCE.js";import"./js-cookie-Cz0CWeBA.js";import"./@casl-B-uYYHKL.js";import"./@ucast-BiZkLRnB.js";import"./@vueuse-B1uMN4GC.js";import"./chart.js-B8s4pPcf.js";import"./vue-advanced-cropper-Cc488Mck.js";import"./dayjs-9DF7GWnL.js";import"./vue3-blocks-tree-BH4O2Ayn.js";import"./vue-BaDTWQb3.js";import"./@unhead-Br2qtGVU.js";import"./unhead-DeLy1NBI.js";import"./hookable-B8xFkYCm.js";import"./@popperjs-D_chPuIy.js";import"./@element-plus-BklxBE5D.js";import"./lodash-es-D7WVGOfI.js";import"./async-validator-9PlIezaS.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@ctrl-r5W6hzzQ.js";const De={class:"content"},Be={class:"content-header"},Ie={class:"mt-auto mb-0"},Te={class:"text-lg font-semibold"},Fe={class:"mt-auto mb-0"},Me={class:"flex justify-between items-center p-4"},Pe={class:"flex items-center gap-2"},Le={class:"flex justify-between items-center p-4"},Re={class:"flex items-center gap-2"},Ue={class:"flex items-center gap-2"},ze={class:"text-end"},wo={__name:"JobPosition",setup(Ne){const{formatDate:q}=ce(),{t:l}=se(),{setTitle:T}=me();te(()=>{T(l("base.job_position",2))});const p=u({page:1,limit:25,q:""}),F=u([]),M=o=>{F.value=o},P=async({queryKey:o})=>{const[s,d]=o;return(await j.get("/settings/job_position",{params:d})).data},{data:_,isLoading:h,isError:xe,error:He,refetch:f}=ie({queryKey:["job_positionList",p.value],queryFn:P,keepPreviousData:!0}),L=ne.debounce(()=>{p.value.page=1,f()},2e3),R=()=>{f()},U=o=>{p.value.page=o,f()},k=u(null),g=u(!1),C=u(""),r=u({id:null,name:null,short_name:null}),z=u({name:[{required:!0,message:l("validation.required",{attribute:l("common.name")}),trigger:"blur"}]}),S=u(!1),N=()=>{C.value=`${l("common.create")} ${l("base.job_position")}`,g.value=!0,r.value.id=null,r.value.name=null},x=o=>{C.value=`${l("common.edit")} ${l("base.job_position")}`,g.value=!0,r.value.id=o.id,r.value.name=o.name},D=()=>{g.value=!1,r.value.id=null,r.value.name=null},H=async()=>{k.value&&k.value.validate(async o=>{if(o){const s=Se.service({customClass:"rounded-md",target:document.querySelector("#modalForm")});try{S.value=!0;const d=r.value.id?`/settings/job_position/${r.value.id}/update`:"/settings/job_position/store",w=r.value.id?"put":"post";await j({method:w,url:d,data:r.value}),g.value=!1,f(),D(),b({message:l("message.success_save"),type:"success"})}catch{S.value=!1,b({message:l("message.error_server"),type:"error"})}s.close()}else b({message:l("message.error_input"),type:"error"})})},J=o=>{qe.confirm(l("message.delete_confirm"),l("message.delete_confirm_title"),{confirmButtonText:l("common.ok"),cancelButtonText:l("common.cancel"),type:"warning"}).then(()=>{j.delete(`/settings/job_position/${o}/delete`).then(()=>{f(),b({type:"success",message:l("message.delete_success")})}).catch(s=>{b({type:"error",message:l("message.delete_cancel")})})}).catch(()=>{b({type:"info",message:l("message.delete_cancel")})})};return(o,s)=>{const d=_e,w=de,V=ge,K=fe,B=be,$=ve,v=we,I=ke,O=Ee,Q=$e,W=he,X=Ce,A=ye,G=ue,Y=je,Z=Ve,ee=pe;return le(),ae("div",De,[m("div",Be,[m("div",Ie,[m("div",Te,i(o.$t("base.job_position",2)),1)]),m("div",Fe,[e(w,{separator:"/"},{default:t(()=>[e(d,{to:{path:"/"}},{default:t(()=>[c(i(o.$t("base.dashboard")),1)]),_:1}),e(d,null,{default:t(()=>[c(i(o.$t("base.setting",2)),1)]),_:1}),e(d,null,{default:t(()=>[c(i(o.$t("base.job_position",2)),1)]),_:1})]),_:1})])]),e(G,{"body-class":"!p-0",class:"!rounded-lg !shadow-md"},{default:t(()=>[m("div",Me,[e(K,{modelValue:p.value.limit,"onUpdate:modelValue":s[0]||(s[0]=n=>p.value.limit=n),placeholder:o.$t("common.select"),disabled:a(h),class:"w-20",onChange:s[1]||(s[1]=n=>a(f)())},{default:t(()=>[e(V,{label:"25",value:"25"}),e(V,{label:"50",value:"50"}),e(V,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","disabled"]),m("div",Pe,[e(B,{modelValue:p.value.q,"onUpdate:modelValue":s[2]||(s[2]=n=>p.value.q=n),onInput:a(L),clearable:"",disabled:a(h)},{prefix:t(()=>[e(a(E),{icon:"mingcute:search-line"})]),_:1},8,["modelValue","onInput","disabled"]),e($,{type:"primary",disabled:a(h),onClick:y(N,["prevent"])},{default:t(()=>[e(a(E),{icon:"mingcute:add-line",class:"me-2"}),c(" "+i(o.$t("common.create")),1)]),_:1},8,["disabled"])])]),e(A,{loading:a(h),animated:""},{template:t(()=>[e(re)]),default:t(()=>[e(W,{class:"min-w-full",data:a(_).data,onSortChange:R,onSelectionChange:M},{default:t(()=>[e(v,{type:"selection",width:"55"}),e(v,{prop:"name",label:o.$t("common.name"),sortable:""},null,8,["label"]),e(v,{label:o.$t("common.created_at")},{default:t(n=>[c(i(a(q)(n.row.created_at)),1)]),_:1},8,["label"]),e(v,{label:o.$t("common.last_updated")},{default:t(n=>[c(i(a(q)(n.row.updated_at)),1)]),_:1},8,["label"]),e(v,{label:o.$t("common.action"),align:"center",width:"150"},{default:t(n=>[e(Q,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:t(()=>[e(O,null,{default:t(()=>[e(I,{class:"flex justify-between",onClick:y(oe=>x(n.row),["prevent"])},{default:t(()=>[e(a(E),{icon:"mingcute:edit-line",class:"me-2"}),c(" "+i(o.$t("common.edit")),1)]),_:2},1032,["onClick"]),e(I,{class:"flex justify-between",onClick:y(oe=>J(n.row.id),["prevent"])},{default:t(()=>[e(a(E),{icon:"mingcute:delete-2-line",class:"me-2"}),c(" "+i(o.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[e($,{type:"primary"},{default:t(()=>[c(i(o.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),m("div",Le,[m("div",Re,[m("span",null,i(o.$t("common.table_paginate",{from:a(_).from,to:a(_).to,total:a(_).total})),1)]),m("div",Ue,[e(X,{class:"float-end",background:"",layout:"prev, pager, next","page-size":a(_).per_page,total:a(_).total,"current-page":a(_).current_page,onCurrentChange:U},null,8,["page-size","total","current-page"])])])]),_:1},8,["loading"])]),_:1}),e(ee,{id:"modalForm",modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=n=>g.value=n),title:C.value,class:"!sm:w-full !w-1/3 rounded-lg","close-on-click-modal":!1,"close-on-press-escape":!1},{default:t(()=>[e(Z,{"label-position":"top",ref_key:"formRef",ref:k,model:r.value,rules:z.value,onSubmit:y(H,["prevent"])},{default:t(()=>[e(Y,{label:o.$t("common.name"),prop:"name"},{default:t(()=>[e(B,{modelValue:r.value.name,"onUpdate:modelValue":s[3]||(s[3]=n=>r.value.name=n)},null,8,["modelValue"])]),_:1},8,["label"]),m("div",ze,[e($,{onClick:y(D,["prevent"])},{default:t(()=>[c(i(o.$t("common.cancel")),1)]),_:1}),e($,{type:"primary","native-type":"submit"},{default:t(()=>[c(i(o.$t("common.save")),1)]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{wo as default};
