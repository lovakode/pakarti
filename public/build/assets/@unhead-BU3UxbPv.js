import{c as j}from"./unhead-M3i9Ttrl.js";import{n as I,v as R,u as O}from"./@vue-BedgDXZT.js";const U=new Set(["title","titleTemplate","script","style","noscript"]),w=new Set(["base","meta","link","style","script","noscript"]),W=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),K=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),E=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]),re=typeof window<"u";function ie(e){return e}function M(e){let t=9;for(let n=0;n<e.length;)t=Math.imul(t^e.charCodeAt(n++),9**9);return((t^t>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function _(e){if(e._h)return e._h;if(e._d)return M(e._d);let t=`${e.tag}:${e.textContent||e.innerHTML||""}:`;for(const n in e.props)t+=`${n}:${String(e.props[n])},`;return M(t)}function q(e,t){return e instanceof Promise?e.then(t):t(e)}function A(e,t,n,r){const i=r||$(typeof t=="object"&&typeof t!="function"&&!(t instanceof Promise)?{...t}:{[e==="script"||e==="noscript"||e==="style"?"innerHTML":"textContent"]:t},e==="templateParams"||e==="titleTemplate");if(i instanceof Promise)return i.then(s=>A(e,t,n,s));const o={tag:e,props:i};for(const s of E){const d=o.props[s]!==void 0?o.props[s]:n[s];d!==void 0&&((!(s==="innerHTML"||s==="textContent"||s==="children")||U.has(o.tag))&&(o[s==="children"?"innerHTML":s]=d),delete o.props[s])}return o.props.body&&(o.tagPosition="bodyClose",delete o.props.body),o.tag==="script"&&typeof o.innerHTML=="object"&&(o.innerHTML=JSON.stringify(o.innerHTML),o.props.type=o.props.type||"application/json"),Array.isArray(o.props.content)?o.props.content.map(s=>({...o,props:{...o.props,content:s}})):o}function B(e,t){var r;const n=e==="class"?" ":";";return t&&typeof t=="object"&&!Array.isArray(t)&&(t=Object.entries(t).filter(([,i])=>i).map(([i,o])=>e==="style"?`${i}:${o}`:i)),(r=String(Array.isArray(t)?t.join(n):t))==null?void 0:r.split(n).filter(i=>!!i.trim()).join(n)}function k(e,t,n,r){for(let i=r;i<n.length;i+=1){const o=n[i];if(o==="class"||o==="style"){e[o]=B(o,e[o]);continue}if(e[o]instanceof Promise)return e[o].then(s=>(e[o]=s,k(e,t,n,i)));if(!t&&!E.has(o)){const s=String(e[o]),d=o.startsWith("data-");s==="true"||s===""?e[o]=d?"true":!0:e[o]||(d&&s==="false"?e[o]="false":delete e[o])}}}function $(e,t=!1){const n=k(e,t,Object.keys(e),0);return n instanceof Promise?n.then(()=>e):e}const V=10;function D(e,t,n){for(let r=n;r<t.length;r+=1){const i=t[r];if(i instanceof Promise)return i.then(o=>(t[r]=o,D(e,t,r)));Array.isArray(i)?e.push(...i):e.push(i)}}function se(e){const t=[],n=e.resolvedInput;for(const i in n){if(!Object.prototype.hasOwnProperty.call(n,i))continue;const o=n[i];if(!(o===void 0||!W.has(i))){if(Array.isArray(o)){for(const s of o)t.push(A(i,s,e));continue}t.push(A(i,o,e))}}if(t.length===0)return[];const r=[];return q(D(r,t,0),()=>r.map((i,o)=>(i._e=e._i,e.mode&&(i._m=e.mode),i._p=(e._i<<V)+o,i)))}const ce=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),x={base:-10,title:10},L={critical:-80,high:-10,low:20};function ae(e){const t=e.tagPriority;if(typeof t=="number")return t;let n=100;return e.tag==="meta"?e.props["http-equiv"]==="content-security-policy"?n=-30:e.props.charset?n=-20:e.props.name==="viewport"&&(n=-15):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in x&&(n=x[e.tag]),t&&t in L?n+L[t]:n}const le=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],F=["name","property","http-equiv"];function G(e){const{props:t,tag:n}=e;if(K.has(n))return n;if(n==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";if(t.id)return`${n}:id:${t.id}`;for(const r of F)if(t[r]!==void 0)return`${n}:${r}:${t[r]}`;return!1}const h="%separator";function N(e,t,n=!1){var i;let r;if(t==="s"||t==="pageTitle")r=e.pageTitle;else if(t.includes(".")){const o=t.indexOf(".");r=(i=e[t.substring(0,o)])==null?void 0:i[t.substring(o+1)]}else r=e[t];if(r!==void 0)return n?(r||"").replace(/"/g,'\\"'):r||""}const J=new RegExp(`${h}(?:\\s*${h})*`,"g");function fe(e,t,n,r=!1){if(typeof e!="string"||!e.includes("%"))return e;let i=e;try{i=decodeURI(e)}catch{}const o=i.match(/%\w+(?:\.\w+)?/g);if(!o)return e;const s=e.includes(h);return e=e.replace(/%\w+(?:\.\w+)?/g,d=>{if(d===h||!o.includes(d))return d;const g=N(t,d.slice(1),r);return g!==void 0?g:d}).trim(),s&&(e.endsWith(h)&&(e=e.slice(0,-h.length)),e.startsWith(h)&&(e=e.slice(h.length)),e=e.replace(J,n).trim()),e}function de(e,t){return e==null?t||null:typeof e=="function"?e(t):e}async function z(e,t={}){const n=t.document||e.resolvedOptions.document;if(!n||!e.dirty)return;const r={shouldRender:!0,tags:[]};if(await e.hooks.callHook("dom:beforeRender",r),!!r.shouldRender)return e._domUpdatePromise||(e._domUpdatePromise=new Promise(async i=>{var C;const o=(await e.resolveTags()).map(c=>({tag:c,id:w.has(c.tag)?_(c):c.tag,shouldRender:!0}));let s=e._dom;if(!s){s={elMap:{htmlAttrs:n.documentElement,bodyAttrs:n.body}};const c=new Set;for(const a of["body","head"]){const l=(C=n[a])==null?void 0:C.children;for(const u of l){const f=u.tagName.toLowerCase();if(!w.has(f))continue;const y={tag:f,props:await $(u.getAttributeNames().reduce((T,v)=>({...T,[v]:u.getAttribute(v)}),{})),innerHTML:u.innerHTML},b=G(y);let p=b,P=1;for(;p&&c.has(p);)p=`${b}:${P++}`;p&&(y._d=p,c.add(p)),s.elMap[u.getAttribute("data-hid")||_(y)]=u}}}s.pendingSideEffects={...s.sideEffects},s.sideEffects={};function d(c,a,l){const u=`${c}:${a}`;s.sideEffects[u]=l,delete s.pendingSideEffects[u]}function g({id:c,$el:a,tag:l}){const u=l.tag.endsWith("Attrs");if(s.elMap[c]=a,u||(l.textContent&&l.textContent!==a.textContent&&(a.textContent=l.textContent),l.innerHTML&&l.innerHTML!==a.innerHTML&&(a.innerHTML=l.innerHTML),d(c,"el",()=>{var f;(f=s.elMap[c])==null||f.remove(),delete s.elMap[c]})),l._eventHandlers)for(const f in l._eventHandlers)Object.prototype.hasOwnProperty.call(l._eventHandlers,f)&&a.getAttribute(`data-${f}`)!==""&&((l.tag==="bodyAttrs"?n.defaultView:a).addEventListener(f.substring(2),l._eventHandlers[f].bind(a)),a.setAttribute(`data-${f}`,""));for(const f in l.props){if(!Object.prototype.hasOwnProperty.call(l.props,f))continue;const y=l.props[f],b=`attr:${f}`;if(f==="class"){if(!y)continue;for(const p of y.split(" "))u&&d(c,`${b}:${p}`,()=>a.classList.remove(p)),!a.classList.contains(p)&&a.classList.add(p)}else if(f==="style"){if(!y)continue;for(const p of y.split(";")){const P=p.indexOf(":"),T=p.substring(0,P).trim(),v=p.substring(P+1).trim();d(c,`${b}:${T}`,()=>{a.style.removeProperty(T)}),a.style.setProperty(T,v)}}else a.getAttribute(f)!==y&&a.setAttribute(f,y===!0?"":String(y)),u&&d(c,b,()=>a.removeAttribute(f))}}const S=[],m={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const c of o){const{tag:a,shouldRender:l,id:u}=c;if(l){if(a.tag==="title"){n.title=a.textContent;continue}c.$el=c.$el||s.elMap[u],c.$el?g(c):w.has(a.tag)&&S.push(c)}}for(const c of S){const a=c.tag.tagPosition||"head";c.$el=n.createElement(c.tag.tag),g(c),m[a]=m[a]||n.createDocumentFragment(),m[a].appendChild(c.$el)}for(const c of o)await e.hooks.callHook("dom:renderTag",c,n,d);m.head&&n.head.appendChild(m.head),m.bodyOpen&&n.body.insertBefore(m.bodyOpen,n.body.firstChild),m.bodyClose&&n.body.appendChild(m.bodyClose);for(const c in s.pendingSideEffects)s.pendingSideEffects[c]();e._dom=s,await e.hooks.callHook("dom:rendered",{renders:o}),i()}).finally(()=>{e._domUpdatePromise=void 0,e.dirty=!1})),e._domUpdatePromise}function Q(e,t={}){const n=t.delayFn||(r=>setTimeout(r,10));return e._domDebouncedUpdatePromise=e._domDebouncedUpdatePromise||new Promise(r=>n(()=>z(e,t).then(()=>{delete e._domDebouncedUpdatePromise,r()})))}function ue(e){return t=>{var r,i;const n=((i=(r=t.resolvedOptions.document)==null?void 0:r.head.querySelector('script[id="unhead:payload"]'))==null?void 0:i.innerHTML)||!1;return n&&t.push(JSON.parse(n)),{mode:"client",hooks:{"entries:updated":o=>{Q(o,e)}}}}}const X=R[0]==="3";function Y(e){return typeof e=="function"?e():O(e)}function H(e){if(e instanceof Promise||e instanceof Date||e instanceof RegExp)return e;const t=Y(e);if(!e||!t)return t;if(Array.isArray(t))return t.map(n=>H(n));if(typeof t=="object"){const n={};for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(r==="titleTemplate"||r[0]==="o"&&r[1]==="n"){n[r]=O(t[r]);continue}n[r]=H(t[r])}return n}return t}const Z={hooks:{"entries:resolve":e=>{for(const t of e.entries)t.resolvedInput=H(t.input)}}},ee="usehead";function te(e){return{install(n){X&&(n.config.globalProperties.$unhead=e,n.config.globalProperties.$head=e,n.provide(ee,e))}}.install}function pe(e={}){e.domDelayFn=e.domDelayFn||(n=>I(()=>setTimeout(()=>n(),0)));const t=j(e);return t.use(Z),t.install=te(t),t}export{ue as D,w as H,re as I,ce as N,le as S,G as a,M as b,pe as c,ie as d,_ as h,se as n,fe as p,de as r,ae as t};
