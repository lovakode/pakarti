import{r as v,q as A,c as h,a,_ as V,X as r,V as l,T as n,S as w,o as d,aa as i,u as P,W as x,Q as B,ai as S,ae as Q}from"./@vue-R74GAGRy.js";import{u as W}from"./vue-i18n-ZNZ64Gzf.js";import{a as X,u as z}from"./vue-router-LsEmCaCE.js";import{i as G,v as H,f as J,j as K,m as O,n as Y,o as Z,k as ee,p as $}from"./element-plus-m-0apcFn.js";import"./@intlify-ChVUvfmF.js";import"./dayjs-9DF7GWnL.js";import"./@popperjs-D_chPuIy.js";import"./@element-plus-BklxBE5D.js";import"./lodash-es-D7WVGOfI.js";import"./async-validator-9PlIezaS.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@ctrl-r5W6hzzQ.js";const se={class:"content"},te={class:"content-header"},ae={class:"content-title"},oe={class:"md:flex hidden items-center gap-2.5 text-sm font-semibold"},ne={class:"p-4"},le={class:"mb-4"},re={class:"md:columns-3 gap-4 px-4"},ie={class:"flex justify-between mb-2 border-b-2 p-4 bg-gray-100"},ue={class:"font-semibold"},ce={class:"flex items-center"},me=["onChange","checked"],de={class:"p-4"},pe={class:"grid grid-cols-2 gap-2"},_e={class:"flex items-center"},ve=["value"],fe={class:"p-4"},Fe={__name:"Form",setup(be){const{t:p}=W(),F=z(),g=X(),I=v(p("common.create")+" "+p("base.role_permission")),t=v({id:null,name:null,lines:[]}),c=v(!1),f=v([]),y=v(null),L=(e,s)=>{const o=s.target.checked;f.value[e].forEach(u=>{o?t.value.lines.includes(u.name)||t.value.lines.push(u.name):t.value.lines=t.value.lines.filter(k=>k!==u.name)})},M=e=>f.value[e].every(s=>t.value.lines.includes(s.name)),R=async()=>{try{c.value=!0;const e=await axios.get("/settings/permissions/list");e.status==200&&(f.value=e.data),c.value=!1}catch(e){console.error(e)}},q=async e=>{try{const s=await axios.get("/settings/permissions/"+e);if(s.status==200){const o=s.data;t.value.id=o.id,t.value.name=o.name,o.permissions.forEach(u=>{t.value.lines.push(u.name)})}}catch(s){console.error(s)}},D=async()=>{y.value&&y.value.validate(async e=>{if(e)try{c.value=!0;const s=t.value.id?`/settings/permissions/${t.value.id}/update`:"/settings/permissions/store",o=t.value.id?"put":"post";await axios({method:o,url:s,data:t.value}),c.value=!1,$({message:p("message.success_input"),type:"success"}),F.replace({path:"/settings/permission"})}catch(s){console.log(s),c.value=!1,$({message:p("message.error_server"),type:"error"})}else $({message:p("message.error_input"),type:"error"})})};return A(()=>{R(),g.params.id&&q(g.params.id)}),(e,s)=>{const o=K,u=G,k=Z,N=Y,E=J,C=ee,j=O,T=H;return d(),h("div",se,[a("div",te,[a("h2",ae,r(I.value),1),a("div",oe,[l(u,{separator:"/"},{default:n(()=>[l(o,{to:{path:"/"}},{default:n(()=>[i(r(e.$t("base.dashboard")),1)]),_:1}),l(o,{to:{path:"/settings"}},{default:n(()=>[i(r(e.$t("base.settings")),1)]),_:1}),l(o,null,{default:n(()=>[i(r(e.$t("base.role_permission")),1)]),_:1}),l(o,null,{default:n(()=>[i(r(e.$t(P(g).params.id?"common.create":"common.edit")),1)]),_:1})]),_:1})])]),V((d(),w(E,{"body-class":"p-0"},{default:n(()=>[l(j,{model:t.value,ref_key:"formRef",ref:y,onSubmit:x(D,["prevent"]),"label-position":"top"},{default:n(()=>[a("div",ne,[l(N,{label:e.$t("base.role"),prop:"name",rules:[{required:!0,message:e.$t("validation.required",{attribute:e.$t("base.role")})}]},{default:n(()=>[l(k,{modelValue:t.value.name,"onUpdate:modelValue":s[0]||(s[0]=b=>t.value.name=b)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),a("div",le,[a("div",re,[(d(!0),h(B,null,S(f.value,(b,_)=>(d(),w(E,{class:"break-inside mb-4","body-class":"!p-0",key:_},{default:n(()=>[a("div",ie,[a("h3",ue,r(e.$t(_)),1),a("label",ce,[a("input",{type:"checkbox",onChange:m=>L(_,m),checked:M(_),class:"mr-2 form-checkbox text-blue-500"},null,40,me),s[3]||(s[3]=i(" Select All "))])]),a("div",de,[a("div",pe,[(d(!0),h(B,null,S(b,m=>(d(),h("div",{key:m.name,class:""},[a("label",_e,[V(a("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=U=>t.value.lines=U),value:m.name,class:"mr-2 form-checkbox text-blue-500"},null,8,ve),[[Q,t.value.lines]]),i(" "+r(_=="base.setting"?e.$t(`base.${m.action}`):e.$t(`common.${m.action}`)),1)])]))),128))])])]),_:2},1024))),128))])]),a("div",fe,[l(C,{type:"danger",plain:"",onClick:s[2]||(s[2]=x(b=>e.$router.go(-1),["prevent"]))},{default:n(()=>[i(r(e.$t("common.cancel")),1)]),_:1}),l(C,{"native-type":"submit",type:"primary"},{default:n(()=>[i(r(e.$t("common.save")),1)]),_:1})])]),_:1},8,["model"])]),_:1})),[[T,c.value]])])}}};export{Fe as default};
