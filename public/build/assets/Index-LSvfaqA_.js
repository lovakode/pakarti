import{q as x,r as F,c as D,a as m,V as e,X as r,T as l,al as ee,o as v,aa as d,u as n,S,P as w,W as V,a0 as le,ak as te}from"./@vue-R74GAGRy.js";import{a as M}from"./axios-D8rVyQy1.js";import{I as g}from"./@iconify-B_FrOzP8.js";import{_ as ae}from"./lodash-BJPsjdUP.js";import{_ as oe}from"./SkeletonTable-cI7fZmbF.js";import{u as se}from"./@tanstack-CrM5e4XN.js";import{u as ne}from"./vue-i18n-ZNZ64Gzf.js";import{u as re,b as me}from"./app-953fMNpm.js";import{_ as de,a as ie}from"./SelectJobPosition-BGWSHewF.js";import{_ as ue}from"./SelectDepartment-D6c4b6uE.js";import{_ as pe}from"./SelectEmployee-BidxO5ve.js";import{u as ce}from"./@casl-B-uYYHKL.js";import{i as _e,f as fe,j as be,s as ve,t as ge,k as we,m as ye,g as $e,h as ke,n as Ve,o as he,u as Ee,q as Ce,r as De,w as Se,x as je,a as Be,b as Ie,c as Te,y as Ue,z as qe,p as j}from"./element-plus-CbVk0LQ5.js";import"./@intlify-ChVUvfmF.js";import"./pinia-AHalXmfd.js";import"./vue-router-LsEmCaCE.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-B1uMN4GC.js";import"./chart.js-B8s4pPcf.js";import"./vue-advanced-cropper-Cc488Mck.js";import"./dayjs-9DF7GWnL.js";import"./vue3-blocks-tree-BH4O2Ayn.js";import"./vue-BaDTWQb3.js";import"./@unhead-Br2qtGVU.js";import"./unhead-DeLy1NBI.js";import"./hookable-B8xFkYCm.js";import"./@ucast-BiZkLRnB.js";import"./@popperjs-D_chPuIy.js";import"./@element-plus-BklxBE5D.js";import"./lodash-es-D7WVGOfI.js";import"./async-validator-9PlIezaS.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@ctrl-r5W6hzzQ.js";const Fe={class:"content"},Me={class:"content-header"},Pe={class:"mt-auto mb-0"},ze={class:"text-lg font-semibold"},Ne={class:"mt-auto mb-0"},Ae={class:"flex justify-between items-center p-4"},Le={class:"flex items-center gap-2"},He={key:0,class:"card-filter p-4"},Ke={class:"flex items-center gap-2"},Oe={class:"flex"},Qe={class:"my-auto"},Re={class:""},We={class:"font-semibold"},Xe={class:"text-sm"},Ge={key:0,class:"text-xs"},Je={class:"flex justify-between items-center p-4"},Ye={class:"flex items-center gap-2"},Ze={class:"flex items-center gap-2"},Ml={__name:"Index",setup(xe){const{formatDate:P}=me(),{t:i}=ne(),{can:h}=ce(),{setTitle:z}=re();x(()=>{z(i("base.employee",2))});const y=F(!1),o=F({limit:25,page:1,q:"",sort:null,sortDir:null,name:null,code:null,status:null,dept:null,pst:null,superior:null}),N=()=>{o.value.name=null,o.value.code=null,o.value.status=null,o.value.dept=null,o.value.pst=null,o.value.superior=null,f()},B=async({queryKey:a})=>{const[s,$]=a;return(await M.get("/employee",{params:$})).data},{data:p,isLoading:E,isError:el,error:ll,refetch:f}=se({queryKey:["customerList",o.value],queryFn:B,keepPreviousData:!0});ae.debounce(()=>{o.value.page=1,f()},1e3);const A=a=>{o.value.sort=a.prop,o.value.sortDir=a.order=="descending"?"DESC":"ASC",f()},L=a=>{o.value.page=a,f()},H=a=>{qe.confirm(i("message.delete_confirm"),i("message.delete_confirm_title"),{confirmButtonText:i("common.ok"),cancelButtonText:i("common.cancel"),type:"warning"}).then(()=>{M.delete(`/employee/${a}/delete`).then(()=>{B(),j({type:"success",message:i("message.delete_success")})}).catch(s=>{j({type:"error",message:i("message.delete_cancel")})})}).catch(()=>{j({type:"info",message:i("message.delete_cancel")})})};return(a,s)=>{const $=be,I=_e,u=ge,T=ve,k=we,U=he,c=Ve,_=ke,K=$e,O=ye,Q=Se,b=De,R=je,q=ee("router-link"),C=Te,W=Ie,X=Be,G=Ce,J=Ue,Y=Ee,Z=fe;return v(),D("div",Fe,[m("div",Me,[m("div",Pe,[m("div",ze,r(a.$t("base.employee",2)),1)]),m("div",Ne,[e(I,{separator:"/"},{default:l(()=>[e($,{to:{path:"/"}},{default:l(()=>[d(r(a.$t("base.dashboard")),1)]),_:1}),e($,null,{default:l(()=>[d(r(a.$t("base.employee",2)),1)]),_:1})]),_:1})])]),e(Z,{"body-class":"!p-0",class:"!rounded-lg !shadow-md"},{default:l(()=>[m("div",Ae,[e(T,{modelValue:o.value.limit,"onUpdate:modelValue":s[0]||(s[0]=t=>o.value.limit=t),placeholder:a.$t("common.select"),disabled:n(E),class:"w-20",onChange:s[1]||(s[1]=t=>n(f)())},{default:l(()=>[e(u,{label:"25",value:"25"}),e(u,{label:"50",value:"50"}),e(u,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","disabled"]),m("div",Le,[e(k,{type:"primary",disabled:n(E),onClick:s[2]||(s[2]=V(t=>y.value=!y.value,["prevent"])),plain:y.value},{default:l(()=>[e(n(g),{icon:"fluent:filter-24-filled",class:"me-2"}),d(" "+r(a.$t("common.filter")),1)]),_:1},8,["disabled","plain"]),n(h)("create","employee")?(v(),S(k,{key:0,tag:"router-link",type:"primary",to:"/employee/create"},{default:l(()=>[e(n(g),{icon:"mingcute:add-line",class:"me-2"}),d(" "+r(`${a.$t("common.add")} ${a.$t("base.employee")}`),1)]),_:1})):w("",!0)])]),e(le,{name:"slide-down"},{default:l(()=>[y.value?(v(),D("div",He,[e(O,{"label-position":"top",onSubmit:V(n(f),["prevent"])},{default:l(()=>[e(K,{gutter:20},{default:l(()=>[e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("common.code")},{default:l(()=>[e(U,{modelValue:o.value.code,"onUpdate:modelValue":s[3]||(s[3]=t=>o.value.code=t),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("common.name")},{default:l(()=>[e(U,{modelValue:o.value.name,"onUpdate:modelValue":s[4]||(s[4]=t=>o.value.name=t),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("common.status")},{default:l(()=>[e(T,{modelValue:o.value.status,"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.status=t),clearable:""},{default:l(()=>[e(u,{value:"permanent",label:a.$t("employee.permanent")},null,8,["label"]),e(u,{value:"contract",label:a.$t("employee.contract")},null,8,["label"]),e(u,{value:"resigned",label:a.$t("employee.resigned")},null,8,["label"]),e(u,{value:"retired",label:a.$t("employee.retired")},null,8,["label"]),e(u,{value:"passed_away",label:a.$t("employee.passed_away")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("base.department")},{default:l(()=>[e(ue,{modelValue:o.value.dept,"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.dept=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("base.job_position")},{default:l(()=>[e(de,{modelValue:o.value.pst,"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.pst=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("base.grade")},{default:l(()=>[e(ie,{modelValue:o.value.grade,"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.grade=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{md:6},{default:l(()=>[e(c,{label:a.$t("employee.superior")},{default:l(()=>[e(pe,{modelValue:o.value.superior,"onUpdate:modelValue":s[9]||(s[9]=t=>o.value.superior=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),m("div",Ke,[e(k,{type:"primary",onClick:V(N,["prevent"])},{default:l(()=>[e(n(g),{icon:"fluent:arrow-clockwise-24-regular",class:"me-2"}),d(" "+r(a.$t("common.reset")),1)]),_:1})])]),_:1},8,["onSubmit"])])):w("",!0)]),_:1}),e(Y,{loading:n(E),animated:""},te({template:l(()=>[e(oe,{rows:15})]),_:2},[n(p)?{name:"default",fn:l(()=>[e(G,{class:"!w-full","scrollbar-always-on":"",data:n(p).data,onSortChange:A},{default:l(()=>[e(b,{prop:"name",label:a.$t("common.name"),sortable:""},{default:l(t=>[m("div",Oe,[e(Q,{class:"!w-10 !h-10 rounded-md me-2",src:t.row.image_path,"preview-src-list":[t.row.image_path],"initial-index":0,"preview-teleported":""},null,8,["src","preview-src-list"]),m("div",Qe,[m("div",Re,r(t.row.code??"-"),1),m("div",We,r(t.row.name),1)])])]),_:1},8,["label"]),e(b,{label:a.$t("employee.gender"),sortable:"",width:"110"},{default:l(t=>[d(r(t.row.gender?a.$t(`employee.${t.row.gender}`):"-"),1)]),_:1},8,["label"]),e(b,{label:a.$t("base.job_position"),width:"200",sortable:""},{default:l(t=>[m("div",null,r(t.row.department?t.row.department.name:"-"),1),m("div",Xe,[d(r(t.row.job_position?t.row.job_position.name:"-")+" ",1),e(R,{size:"small"},{default:l(()=>[d(r(t.row.grade?t.row.grade.name:"-"),1)]),_:2},1024)])]),_:1},8,["label"]),e(b,{prep:"ptkp",label:a.$t("employee.ptkp"),sortable:"",width:"90"},{default:l(t=>[d(r(t.row.ptkp??"-"),1)]),_:1},8,["label"]),e(b,{prep:"status",label:a.$t("common.status"),sortable:"",width:"140"},{default:l(t=>[d(r(t.row.status?a.$t(`employee.${t.row.status}`):"-")+" ",1),["resigned","retired"].includes(t.row.status)?(v(),D("div",Ge,r(n(P)(t.row.exit_date)),1)):w("",!0)]),_:1},8,["label"]),e(b,{label:a.$t("common.action"),align:"center",width:"120"},{default:l(t=>[e(X,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:l(()=>[e(W,null,{default:l(()=>[e(C,{class:"w-full"},{default:l(()=>[e(q,{to:`/employee/${t.row.id}`,class:"flex justify-between"},{default:l(()=>[e(n(g),{icon:"mingcute:eye-line",class:"me-2"}),d(" "+r(a.$t("common.view")),1)]),_:2},1032,["to"])]),_:2},1024),n(h)("update","employee")?(v(),S(C,{key:0,class:"w-full"},{default:l(()=>[e(q,{to:`/employee/${t.row.id}/edit`,class:"flex justify-between"},{default:l(()=>[e(n(g),{icon:"mingcute:edit-line",class:"me-2"}),d(" "+r(a.$t("common.edit")),1)]),_:2},1032,["to"])]),_:2},1024)):w("",!0),n(h)("delete","employee")?(v(),S(C,{key:1,class:"flex justify-between",onClick:V(tl=>H(t.row.id),["prevent"])},{default:l(()=>[e(n(g),{icon:"mingcute:delete-2-line",class:"me-2"}),d(" "+r(a.$t("common.delete")),1)]),_:2},1032,["onClick"])):w("",!0)]),_:2},1024)]),default:l(()=>[e(k,{type:"primary"},{default:l(()=>[d(r(a.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),m("div",Je,[m("div",Ye,[m("span",null,r(a.$t("common.table_paginate",{from:n(p).from,to:n(p).to,total:n(p).total})),1)]),m("div",Ze,[e(J,{class:"float-end",background:"",layout:"prev, pager, next","page-size":n(p).per_page,total:n(p).total,"current-page":o.value.page,onCurrentChange:L},null,8,["page-size","total","current-page"])])])]),key:"0"}:void 0]),1032,["loading"])]),_:1})])}}};export{Ml as default};
